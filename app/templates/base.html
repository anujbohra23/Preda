<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>{% block title %}HealthAssist{% endblock %} — HealthAssist</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}"/>
</head>
<body class="bg-slate-50 min-h-screen flex flex-col">

{# ── Global emergency banner ──────────────────────────────────────────────── #}
{% with messages = get_flashed_messages(category_filter=['emergency']) %}
  {% if messages %}
    <div class="bg-red-600 text-white text-center py-3 px-6
                text-sm font-semibold shadow-lg z-50">
      {% for message in messages %}
        {{ message }}
      {% endfor %}
      &nbsp;—&nbsp;
      <strong>Call emergency services immediately: 911 / 999 / 112</strong>
    </div>
  {% endif %}
{% endwith %}

{# ── Nav ──────────────────────────────────────────────────────────────────── #}
<nav class="bg-white border-b border-slate-200 shadow-sm">
  <div class="max-w-5xl mx-auto px-4 h-14 flex items-center justify-between">

    {# Logo #}
    <a href="{{ url_for('main.landing') }}"
       class="font-bold text-blue-700 text-lg tracking-tight">
      ⚕ HealthAssist
    </a>

    {# Nav links #}
    <div class="flex items-center gap-4">
      {% if current_user.is_authenticated %}
        <a href="{{ url_for('sessions.dashboard') }}"
           class="text-sm text-slate-600 hover:text-slate-900
                  transition-colors">
          Dashboard
        </a>
        <a href="{{ url_for('history.history') }}"
           class="text-sm text-slate-600 hover:text-slate-900
                  transition-colors">
          History
        </a>
        <a href="{{ url_for('settings.settings') }}"
           class="text-sm text-slate-600 hover:text-slate-900
                  transition-colors">
          Settings
        </a>
        <div class="h-4 w-px bg-slate-200"></div>
        <span class="text-xs text-slate-400 hidden sm:block">
          {{ current_user.email }}
        </span>
        <a href="{{ url_for('auth.logout') }}"
           class="text-sm bg-slate-100 hover:bg-slate-200 text-slate-700
                  px-3 py-1.5 rounded-md transition-colors font-medium">
          Sign Out
        </a>
      {% else %}
        <a href="{{ url_for('auth.login') }}"
           class="text-sm text-slate-600 hover:text-slate-900
                  transition-colors">
          Log In
        </a>
        <a href="{{ url_for('auth.signup') }}"
           class="text-sm bg-blue-600 hover:bg-blue-700 text-white
                  font-semibold px-4 py-1.5 rounded-md transition-colors">
          Sign Up
        </a>
      {% endif %}
    </div>
  </div>
</nav>

{# ── Disclaimer bar ───────────────────────────────────────────────────────── #}
<div class="bg-amber-50 border-b border-amber-200 py-1.5 px-4 text-center">
  <p class="text-xs text-amber-700">
    ⚠ <strong>Not medical advice.</strong>
    HealthAssist is an informational tool only.
    Always consult a qualified healthcare professional.
  </p>
</div>

{# ── Flash messages ───────────────────────────────────────────────────────── #}
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
  <div class="max-w-5xl mx-auto px-4 mt-4 space-y-2">
    {% for category, message in messages %}
      {% if category != 'emergency' %}
      <div class="rounded-lg px-4 py-3 text-sm font-medium
        {% if category == 'success' %}
          bg-green-50 border border-green-200 text-green-800
        {% elif category == 'error' %}
          bg-red-50 border border-red-200 text-red-800
        {% elif category == 'warning' %}
          bg-amber-50 border border-amber-200 text-amber-800
        {% else %}
          bg-blue-50 border border-blue-200 text-blue-800
        {% endif %}">
        {{ message }}
      </div>
      {% endif %}
    {% endfor %}
  </div>
  {% endif %}
{% endwith %}

{# ── Main content ─────────────────────────────────────────────────────────── #}
<main class="flex-1 max-w-5xl mx-auto w-full px-4 py-6">
  {% block content %}{% endblock %}
</main>

{# ── Footer ───────────────────────────────────────────────────────────────── #}
<footer class="bg-white border-t border-slate-200 mt-auto">
  <div class="max-w-5xl mx-auto px-4 py-4 flex items-center
              justify-between text-xs text-slate-400">
    <span>© 2026 HealthAssist MVP — Informational tool only</span>
    <span>Not a medical device. Not a substitute for professional care.</span>
  </div>
</footer>

</body>
</html>